{
  if (SHOW_LOGS)   Logger.v(TAG,">> prepare, mState " + mState);
synchronized (mState) {
switch (mState.get()) {
case STOPPED:
case INITIALIZED:
      try {
        mMediaPlayer.prepare();
        mState.set(State.PREPARED);
        if (mListener != null) {
          mListener.onVideoPrepared();
        }
      }
 catch (      IllegalStateException ex) {
        if (SHOW_LOGS)         Logger.err(TAG,"catch exception [" + ex + "]");
        mState.set(State.ERROR);
        if (mListener != null) {
          mListener.onError(1,-1004);
        }
      }
catch (      IOException ex) {
        if (SHOW_LOGS)         Logger.err(TAG,"catch IO exception [" + ex + "]");
        mState.set(State.ERROR);
        if (mListener != null) {
          mListener.onError(1,-1004);
        }
      }
    break;
case IDLE:
case PREPARING:
case PREPARED:
case STARTED:
case PAUSED:
case PLAYBACK_COMPLETED:
case END:
case ERROR:
  throw new IllegalStateException("prepare, called from illegal state " + mState);
}
}
if (SHOW_LOGS) Logger.v(TAG,"<< prepare, mState " + mState);
}
